<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Template</title>

</head>

<body>

    <main>

    </main>

</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>
    var lat;
    var long;

    // function getLocation() {
    //     if (navigator.geolocation) {
    //         navigator.geolocation.getCurrentPosition(showPosition);
    //     } else {
    //         console.log("Geolocation is not supported by this browser.");
    //     }
    // }
    // function showPosition(position) {
    //     // console.log("Latitude: " + position.coords.latitude +
    //     //     "Longitude: " + position.coords.longitude);

    //     lat = position.coords.latitude;
    //     long = position.coords.longitude;
    //     console.log(long,lat)
    //     makeCall(long, lat)
    // }

    // getLocation()

    // var APIKey = "166a433c57516f51dfab1f7edaed8413";
    // var locationZip = zip=94102,us
    // var queryURL = "https://api.openweathermap.org/data/2.5/weather?q=" + locationZip + "&appid=" + APIKey;
    
    var place = prompt('Enter a City or Town: ').toLowerCase().trim();
    var country = prompt('Enter a Country or State Initials: ').toLowerCase().trim();

    function callGeo(){
        $.ajax({
        url: 'https://maps.googleapis.com/maps/api/geocode/json?address=' + place + country +'&key=AIzaSyCd001KkrxyfVaMHMnO9UUbZYHN6ZTU3RQ',
        method: "GET",
        type: "json"
    }).then(function (response) {
        console.log(response)
        // console.log(response.results[0].geometry.location)
        // console.log(response.results[0].geometry.location.lng)
        var latGeo = response.results[0].geometry.location.lat
        var longGeo = response.results[0].geometry.location.lng
        callHiking(latGeo, longGeo)
    });
    }

    function callHiking(latGeo,longGeo){
        $.ajax({
        // url: 'https://data.sfgov.org/api/views/u2ac-gv9v/rows.xml',
        url: 'https://www.hikingproject.com/data/get-trails?lat=' + latGeo + '&' + 'lon=' + longGeo + '&maxDistance=10&key=200381349-b66dbdd97d00ee3c460e33b5beb94b9f',
        method: "GET",
        type: "json"
    }).then(function (response) {
        console.log('Trails')
        console.log(response)
       
        if(response.trails.length === 0) {
            console.log("No Trails Here. Search in a different location.")
        }else {
            var latitude = response.trails[0].latitude;
            var longitude = response.trails[0].longitude;
            callWeather(latitude, longitude)
        }
        
    });
    }

    function callWeather(lat, lon){
        $.ajax({
        url: "https://api.openweathermap.org/data/2.5/weather?lat=" + lat + '&' + "lon=" + lon + "&appid=" + '166a433c57516f51dfab1f7edaed8413',
        method: "GET",
        type: "json"

    }).then(function (response) {
        console.log('Weather')
        console.log(response)

    });
    }

    callGeo()

</script>


</html>